// Generated by CoffeeScript 1.6.2
(function() {
  var querystring, request;

  require('coffee-script');

  request = require('request');

  querystring = require('querystring');

  module.exports = function(client_id, client_secret) {
    var credentials, date, day, month, today;

    today = new Date();
    month = today.getMonth() + 1;
    if (month < 10) {
      month = '0' + month;
    }
    day = today.getDate();
    if (day < 10) {
      day = '0' + day;
    }
    date = today.getFullYear() + '' + month + '' + day;
    credentials = {
      'v': date,
      'client_id': client_id,
      'client_secret': client_secret
    };
    return {
      getVenues: function(params, callback) {
        var urlString;

        urlString = "https://api.foursquare.com/v2/venues/search?" + querystring.stringify(params) + '&' + querystring.stringify(credentials);
        return request(urlString, function(error, response, body) {
          if (!error && response.statusCode === 200) {
            callback(null, JSON.parse(body));
          }
          return callback(JSON.parse(body), null);
        });
      },
      exploreVenues: function(params, callback) {
        var urlString;

        urlString = "https://api.foursquare.com/v2/venues/explore?" + querystring.stringify(params)(+'&' + querystring.stringify(credentials));
        return request(urlString, function(error, response, body) {
          if (!error && response.statusCode === 200) {
            callback(null, JSON.parse(body));
          }
          return callback(JSON.parse(body), null);
        });
      },
      getVenue: function(params, callback) {
        var urlString;

        urlString = "https://api.foursquare.com/v2/venues/" + querystring.stringify(params) + '&' + querystring.stringify(credentials);
        return request(urlString, function(error, response, body) {
          if (!error && response.statusCode === 200) {
            callback(null, JSON.parse(body));
          }
          return callback(JSON.parse(body), null);
        });
      }
    };
  };

}).call(this);
